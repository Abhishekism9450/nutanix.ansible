---
- name: Auto Generated Playbook
  hosts: localhost
  vars_files: credentials.yml
  gather_facts: false
  tasks:
  - name: create Vm
    nutanix_vms:
      action: create
      auth:
        credentials: '{{credentials}}'
        url: '{{config.ip_address}}:{{config.port}}'
      name: "test1234"
      cluster:
        cluster_uuid: "0005d433-f986-ca07-7cba-ac1f6b6f97d8"
      networks:
        - subnet_reference:
            uuid: "337261ed-5007-4e5a-b11e-8d2444e62824"
            kind: "subnet"
          is_connected: True
#        - subnet_reference:
#            uuid: "337261ed-5007-4e5a-b11e-8d2444e62824"
#            kind: "subnet"
#          is_connected: True


    register: output

  - name: output of list Subnets
    debug:
      msg: '{{ output }}'
